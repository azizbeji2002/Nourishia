{% extends 'base.html.twig' %}

{% block title %}Liste des Posts{% endblock %}

{% block body %}
	<div class="container mt-5">
		<h1 class="post-title text-center animate__animated animate__fadeIn">
			<span class="text-gradient">ğŸ“ Liste des Posts</span>
		</h1>
		<hr class="title-underline mb-5">

		<div class="text-center mb-4">
			<a href="{{ path('ajouterPoste') }}" class="btn btn-success btn-lg shadow-sm">â• Ajouter un Poste</a>
		</div>

		{% if posts is not empty %}
			<div class="d-flex flex-column align-items-center">
				{% for post in posts %}
					<div class="post-card w-100 mb-4 p-4 shadow-lg border-0 rounded-4 animate__animated animate__fadeInUp">
						<h3 class="text-primary fw-bold">{{ post.titre }}</h3>
						<p class="text-muted">ğŸ“… PubliÃ© le : {{ post.datePublication|date('d M Y') }}</p>

						<p>
							
						</p>

						<p><strong>ğŸ“ DÃ©tails :</strong> {{ post.contenue }}</p>

						{% if post.commentaires is not empty %}
							<div class="mt-3">
								<h5 class="text-secondary">ğŸ’¬ Commentaires</h5>

								{% for commentaire in post.commentaires %}
									{% if commentaire.nbrSignal >= 1 %}
										<div class="alert alert-warning text-center alert-fade" role="alert">
											ğŸš¨ Ce commentaire a Ã©tÃ© signalÃ© pour non-conformitÃ© !
										</div>
									{% endif %}

									<div class="comment-card mt-2 p-3 bg-light rounded d-flex justify-content-between align-items-center">
										<p class="mb-0">{{ commentaire.contenu }}</p>

										{% if commentaire.nbrSignal >= 10 %}
											<span class="badge bg-danger">SupprimÃ©</span>
										{% else %}
											<div>
												<a href="{{ path('commentaire_edit', {'id': commentaire.id}) }}" class="btn btn-sm btn-outline-primary">âœï¸ Modifier</a>
												<a href="{{ path('commentaire_delete', {'id': commentaire.id}) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Voulez-vous vraiment supprimer ce commentaire ?')">ğŸ—‘ï¸ Supprimer</a>
												<a href="{{ path('commentaire_signal', {'id': commentaire.id}) }}" class="btn btn-sm btn-outline-warning">âš ï¸ Signaler</a>
											</div>
										{% endif %}
									</div>
								{% endfor %}
							</div>
						{% else %}
							<p class="text-muted mt-2">Aucun commentaire pour le moment</p>
						{% endif %}

						<div class="d-flex justify-content-between mt-3">
							<a href="{{ path('modifierPoste', {'id': post.id}) }}" class="btn btn-sm btn-outline-primary">âœï¸ Modifier</a>
							<a href="{{ path('creecommentaire', {'postId': post.id}) }}" class="btn btn-sm btn-outline-success">ğŸ’¬ Ajouter un Commentaire</a>
							<a href="{{ path('post_delete', {'id': post.id}) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Voulez-vous vraiment supprimer ce post ?')">ğŸ—‘ï¸ Supprimer</a>
						</div>
					</div>
				{% endfor %}
			</div>
		{% else %}
			<div class="alert alert-info text-center animate__animated animate__fadeIn">
				ğŸ“­ Aucun post trouvÃ©. Ajoutez-en un !
			</div>
		{% endif %}
	</div>

	<style>
		.post-title {
			font-size: 2.2rem;
			font-weight: bold;
			color: #333;
			margin-bottom: 10px;
		}
		.title-underline {
			width: 50px;
			height: 4px;
			background: #ff66b2;
			border-radius: 2px;
			margin: 0 auto 30px;
		}
		.post-card {
			background: #fff;
			width: 80%;
			max-width: 800px;
			border-left: 5px solid #ff66b2;
			transition: all 0.3s ease-in-out;
		}
		.post-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
		}
		.btn-sm {
			padding: 5px 10px;
			font-size: 0.875rem;
		}
		.btn-lg {
			padding: 10px 20px;
			font-size: 1rem;
		}
		.comment-card {
			border-left: 3px solid #ff66b2;
		}
		.alert-custom {
			background-color: #ffcc00;
			color: #000;
			border-radius: 5px;
			padding: 15px;
			margin-bottom: 20px;
			display: none; /* Initialement cachÃ© */
			transition: opacity 0.5s ease-in-out;
		}
	</style>

	<style>
		.alert-fade {
			animation: fadeOut 10s forwards;
		}

		@keyframes fadeOut {
			0% {
				opacity: 1;
			}
			100% {
				opacity: 0;
				display: none;
			}
		}
	</style>

	<link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" rel="stylesheet">
{% endblock %}
